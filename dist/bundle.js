(()=>{"use strict";var e;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(e||(e={}));class t{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class n extends class{constructor(){this.listeners=[]}addListeners(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new n),this.instance}addProject(n,r,s){const i=new t(Math.random().toString(),n,r,s,e.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const r=n.getInstance();function s(e,t,n){const r=null==n?void 0:n.value;return{configurable:!0,get(){return r.bind(this)}}}class i{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}var l=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class o extends i{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("Drag End")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}l([s],o.prototype,"dragStartHandler",null),l([s],o.prototype,"dragEndHandler",null);var a=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class c extends i{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(t){const n=t.dataTransfer.getData("text/plain");r.moveProject(n,"active"===this.type?e.Active:e.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),r.addListeners((t=>{const n=null==t?void 0:t.filter((t=>"active"===this.type?t.status===e.Active:t.status===e.Finished));this.assignedProjects=n,this.renderProjects()}))}renderContent(){const e=`${this.type}-project-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=`${this.type.toUpperCase()} PROJECTS`}renderProjects(){document.getElementById(`${this.type}-project-list`).innerHTML="";for(const e of this.assignedProjects)new o(this.element.querySelector("ul").id,e)}}function d(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}a([s],c.prototype,"dragOverHandler",null),a([s],c.prototype,"dropHandler",null),a([s],c.prototype,"dragLeaveHandler",null);class u extends i{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0,minLength:5},s={value:+n,required:!0,min:1,max:5};return d({value:e,required:!0})&&d(r)&&d(s)?[e,t,+n]:void alert("Invalid Input, try again!!!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,s]=t;r.addProject(e,n,s),this.clearInputs()}}}(function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)})([s],u.prototype,"submitHandler",null),new u,new c("active"),new c("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0Qsa0JBQ04sTUFBTUMsRUFBZXBHLEtBQUsrRixrQkFBa0JwRSxNQUN0QzBFLEVBQXFCckcsS0FBS2dHLHdCQUF3QnJFLE1BQ2xEMkUsRUFBZ0J0RyxLQUFLaUcsbUJBQW1CdEUsTUFPeEM0RSxFQUFzQyxDQUMxQzVFLE1BQU8wRSxFQUNQYixVQUFVLEVBQ1ZFLFVBQVcsR0FHUGMsRUFBaUMsQ0FDckM3RSxPQUFRMkUsRUFDUmQsVUFBVSxFQUNWSSxJQUFLLEVBQ0xDLElBQUssR0FHUCxPQUNHUixFQW5CbUMsQ0FDcEMxRCxNQUFPeUUsRUFDUFosVUFBVSxLQWtCVEgsRUFBU2tCLElBQ1RsQixFQUFTbUIsR0FLSCxDQUFDSixFQUFjQyxHQUFxQkMsUUFIM0NHLE1BQU0sK0JBT0ZDLGNBQ04xRyxLQUFLK0Ysa0JBQWtCcEUsTUFBUSxHQUMvQjNCLEtBQUtnRyx3QkFBd0JyRSxNQUFRLEdBQ3JDM0IsS0FBS2lHLG1CQUFtQnRFLE1BQVEsR0FJMUJ1RSxjQUFjNUMsR0FDcEJBLEVBQU1lLGlCQUNOLE1BQU1zQyxFQUFZM0csS0FBS21HLGtCQUV2QixHQUFJUyxNQUFNQyxRQUFRRixHQUFZLENBQzVCLE1BQU9uSCxFQUFPc0gsRUFBTXBILEdBQVVpSCxFQUU5QnZGLEVBQWFkLFdBQVdkLEVBQU9zSCxFQUFNcEgsR0FDckNNLEtBQUswRyxpQiwyVEFSVCxFQURDcEYsRyxrQ0N2RUgsSUFBSXdFLEVBQ0osSUFBSTlCLEVBQVksVUFDaEIsSUFBSUEsRUFBWSxhIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHMtZHJhZy1kcm9wLXBtLy4vc3JjL21vZGVscy9wcm9qZWN0LnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC1wbS8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC1wbS8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC1wbS8uL3NyYy9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50LnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC1wbS8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly90cy1kcmFnLWRyb3AtcG0vLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdHMtZHJhZy1kcm9wLXBtLy4vc3JjL3V0aWxzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vdHMtZHJhZy1kcm9wLXBtLy4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly90cy1kcmFnLWRyb3AtcG0vLi9zcmMvYXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFByb2plY3QgVHlwZVxyXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcclxuICBBY3RpdmUsXHJcbiAgRmluaXNoZWQsXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHB1YmxpYyBpZDogc3RyaW5nLFxyXG4gICAgcHVibGljIHRpdGxlOiBzdHJpbmcsXHJcbiAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcclxuICAgIHB1YmxpYyBwZW9wbGU6IG51bWJlcixcclxuICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXNcclxuICApIHt9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLy4uL21vZGVscy9wcm9qZWN0XCI7XHJcbi8vIFByb2plY3QgU3RhdGVcclxuXHJcbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcclxuXHJcbmNsYXNzIFN0YXRlPFQ+IHtcclxuICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XHJcblxyXG4gIGFkZExpc3RlbmVycyhsaXN0ZW5lckZuOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lckZuKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XHJcbiAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XHJcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XHJcbiAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XHJcbiAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBwZW9wbGU6IG51bWJlcikge1xyXG4gICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KFxyXG4gICAgICBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCksXHJcbiAgICAgIHRpdGxlLFxyXG4gICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgcGVvcGxlLFxyXG4gICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XHJcbiAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgbW92ZVByb2plY3QocHJvamVjdElkOiBzdHJpbmcsIG5ld1N0YXR1czogUHJvamVjdFN0YXR1cykge1xyXG4gICAgY29uc3QgcHJvamVjdCA9IHRoaXMucHJvamVjdHMuZmluZCgocHJqKSA9PiBwcmouaWQgPT09IHByb2plY3RJZCk7XHJcblxyXG4gICAgaWYgKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cykge1xyXG4gICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcclxuICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKSB7XHJcbiAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKTtcclxuIiwiLy8gQXV0b0JpbmQgRnVuY3Rpb25cclxuZXhwb3J0IGZ1bmN0aW9uIGF1dG9CaW5kKFxyXG4gIHRhcmdldDogYW55LFxyXG4gIG1ldGhvZE5hbWU6IHN0cmluZyxcclxuICBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3JcclxuKSB7XHJcbiAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yPy52YWx1ZTtcclxuICBjb25zdCBhZGpEZXNjcmlwdGlvbjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xyXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgZ2V0KCkge1xyXG4gICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcclxuICAgICAgcmV0dXJuIGJvdW5kRm47XHJcbiAgICB9LFxyXG4gIH07XHJcbiAgcmV0dXJuIGFkakRlc2NyaXB0aW9uO1xyXG59XHJcbiIsIi8vIENvbXBvbmVudCBCYXNlIENsYXNzXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcclxuICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgaG9zdEVsZW1lbnQ6IFQ7XHJcbiAgZWxlbWVudDogVTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB0ZW1wbGF0ZUlkOiBzdHJpbmcsXHJcbiAgICBob3N0RWxlbWVudElkOiBzdHJpbmcsXHJcbiAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxyXG4gICAgbmV3RWxlbWVudElkPzogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gICAgICB0ZW1wbGF0ZUlkXHJcbiAgICApISBhcyBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xyXG5cclxuICAgIGNvbnN0IGltcG9ydGVkTm9kZSA9IGRvY3VtZW50LmltcG9ydE5vZGUoXHJcbiAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsXHJcbiAgICAgIHRydWVcclxuICAgICkhO1xyXG4gICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0ZWROb2RlLmZpcnN0RWxlbWVudENoaWxkISBhcyBVO1xyXG4gICAgaWYgKG5ld0VsZW1lbnRJZCkge1xyXG4gICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRTdGFydCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdEJlZ2lubmluZzogYm9vbGVhbikge1xyXG4gICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXHJcbiAgICAgIGluc2VydEF0QmVnaW5uaW5nID8gXCJhZnRlcmJlZ2luXCIgOiBcImJlZm9yZWVuZFwiLFxyXG4gICAgICB0aGlzLmVsZW1lbnRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBhYnN0cmFjdCBjb25maWd1cmUoKTogdm9pZDtcclxuXHJcbiAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG59XHJcbiIsIi8vIFByb2plY3RJdGVtIENsYXNzXHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuLi9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IERyYWdnYWJsZSB9IGZyb20gXCIuLi9tb2RlbHMvZHJhZy1kcm9wXCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgYXV0b0JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtXHJcbiAgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCwgSFRNTExJRWxlbWVudD5cclxuICBpbXBsZW1lbnRzIERyYWdnYWJsZVxyXG57XHJcbiAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0O1xyXG5cclxuICBnZXQgcGVyc29ucygpIHtcclxuICAgIGlmICh0aGlzLnByb2plY3QucGVvcGxlID09PSAxKSB7XHJcbiAgICAgIHJldHVybiBcIjEgcGVyc29uXCI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYCR7dGhpcy5wcm9qZWN0LnBlb3BsZX0gcGVyc29uc2A7XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xyXG4gICAgc3VwZXIoXCJzaW5nbGUtcHJvamVjdFwiLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcclxuXHJcbiAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xyXG5cclxuICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcclxuICB9XHJcblxyXG4gIEBhdXRvQmluZFxyXG4gIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKFwidGV4dC9wbGFpblwiLCB0aGlzLnByb2plY3QuaWQpO1xyXG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gXCJtb3ZlXCI7XHJcbiAgfVxyXG5cclxuICBAYXV0b0JpbmRcclxuICBkcmFnRW5kSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkRyYWcgRW5kXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uZmlndXJlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKTtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCB0aGlzLmRyYWdFbmRIYW5kbGVyKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckNvbnRlbnQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcImgyXCIpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC50aXRsZTtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiaDNcIikhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgXCIgYXNzaWduZWRcIjtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwicFwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gXCIuLy4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcclxuaW1wb3J0IHsgYXV0b0JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcclxuaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiO1xyXG5cclxuLy8gUHJvamVjdCBMaXN0IENsYXNzXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0TGlzdFxyXG4gIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD5cclxuICBpbXBsZW1lbnRzIERyYWdUYXJnZXRcclxue1xyXG4gIGFzc2lnbmVkUHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6IFwiYWN0aXZlXCIgfCBcImZpbmlzaGVkXCIpIHtcclxuICAgIHN1cGVyKFwicHJvamVjdC1saXN0XCIsIFwiYXBwXCIsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApO1xyXG5cclxuICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcclxuICB9XHJcblxyXG4gIEBhdXRvQmluZFxyXG4gIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gXCJ0ZXh0L3BsYWluXCIpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSE7XHJcbiAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKFwiZHJvcHBhYmxlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQGF1dG9CaW5kXHJcbiAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgY29uc3QgcHJqSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoXCJ0ZXh0L3BsYWluXCIpO1xyXG4gICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KFxyXG4gICAgICBwcmpJZCxcclxuICAgICAgdGhpcy50eXBlID09PSBcImFjdGl2ZVwiID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgQGF1dG9CaW5kXHJcbiAgZHJhZ0xlYXZlSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpITtcclxuICAgIGxpc3RFbC5jbGFzc0xpc3QucmVtb3ZlKFwiZHJvcHBhYmxlXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uZmlndXJlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIHRoaXMuZHJvcEhhbmRsZXIpO1xyXG5cclxuICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcnMoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcclxuICAgICAgY29uc3QgcmVsZXZhbnRQcm9qZWN0cyA9IHByb2plY3RzPy5maWx0ZXIoKHByaikgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09IFwiYWN0aXZlXCIpIHtcclxuICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuRmluaXNoZWQ7XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmFudFByb2plY3RzO1xyXG4gICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckNvbnRlbnQoKSB7XHJcbiAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3QtbGlzdGA7XHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpIS5pZCA9IGxpc3RJZDtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcImgyXCJcclxuICAgICkhLnRleHRDb250ZW50ID0gYCR7dGhpcy50eXBlLnRvVXBwZXJDYXNlKCl9IFBST0pFQ1RTYDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVuZGVyUHJvamVjdHMoKSB7XHJcbiAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcclxuICAgICAgYCR7dGhpcy50eXBlfS1wcm9qZWN0LWxpc3RgXHJcbiAgICApISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgbGlzdEVsLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICBmb3IgKGNvbnN0IHByakl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKSB7XHJcbiAgICAgIG5ldyBQcm9qZWN0SXRlbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpIS5pZCwgcHJqSXRlbSk7XHJcbiAgICAgIC8vIGNvbnN0IGxpc3RJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xyXG4gICAgICAvLyBsaXN0SXRlbS50ZXh0Q29udGVudCA9IHByakl0ZW0udGl0bGU7XHJcbiAgICAgIC8vIGxpc3RFbC5hcHBlbmRDaGlsZChsaXN0SXRlbSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIi8vIFZhbGlkYXRpb25cclxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XHJcbiAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcclxuICByZXF1aXJlZD86IGJvb2xlYW47XHJcbiAgbWluTGVuZ3RoPzogbnVtYmVyO1xyXG4gIG1heExlbmd0aD86IG51bWJlcjtcclxuICBtaW4/OiBudW1iZXI7XHJcbiAgbWF4PzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGVibGVJbnB1dDogVmFsaWRhdGFibGUpIHtcclxuICBsZXQgaXNWYWxpZCA9IHRydWU7XHJcbiAgaWYgKHZhbGlkYXRlYmxlSW5wdXQucmVxdWlyZWQpIHtcclxuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRlYmxlSW5wdXQudmFsdWUudG9TdHJpbmcoKS5sZW5ndGggIT09IDA7XHJcbiAgfVxyXG4gIGlmIChcclxuICAgIHZhbGlkYXRlYmxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiZcclxuICAgIHR5cGVvZiB2YWxpZGF0ZWJsZUlucHV0LnZhbHVlID09PSBcInN0cmluZ1wiXHJcbiAgKSB7XHJcbiAgICBpc1ZhbGlkID1cclxuICAgICAgaXNWYWxpZCAmJiB2YWxpZGF0ZWJsZUlucHV0LnZhbHVlLmxlbmd0aCA+PSB2YWxpZGF0ZWJsZUlucHV0Lm1pbkxlbmd0aDtcclxuICB9XHJcbiAgaWYgKFxyXG4gICAgdmFsaWRhdGVibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJlxyXG4gICAgdHlwZW9mIHZhbGlkYXRlYmxlSW5wdXQudmFsdWUgPT09IFwic3RyaW5nXCJcclxuICApIHtcclxuICAgIGlzVmFsaWQgPVxyXG4gICAgICBpc1ZhbGlkICYmIHZhbGlkYXRlYmxlSW5wdXQudmFsdWUubGVuZ3RoIDw9IHZhbGlkYXRlYmxlSW5wdXQubWF4TGVuZ3RoO1xyXG4gIH1cclxuICBpZiAoXHJcbiAgICB2YWxpZGF0ZWJsZUlucHV0Lm1pbiAhPSBudWxsICYmXHJcbiAgICB0eXBlb2YgdmFsaWRhdGVibGVJbnB1dC52YWx1ZSA9PT0gXCJudW1iZXJcIlxyXG4gICkge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGVibGVJbnB1dC52YWx1ZSA+PSB2YWxpZGF0ZWJsZUlucHV0Lm1pbjtcclxuICB9XHJcbiAgaWYgKFxyXG4gICAgdmFsaWRhdGVibGVJbnB1dC5tYXggIT0gbnVsbCAmJlxyXG4gICAgdHlwZW9mIHZhbGlkYXRlYmxlSW5wdXQudmFsdWUgPT09IFwibnVtYmVyXCJcclxuICApIHtcclxuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRlYmxlSW5wdXQudmFsdWUgPD0gdmFsaWRhdGVibGVJbnB1dC5tYXg7XHJcbiAgfVxyXG4gIHJldHVybiBpc1ZhbGlkO1xyXG59XHJcbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IFZhbGlkYXRhYmxlLCB2YWxpZGF0ZSB9IGZyb20gXCIuLi91dGlscy92YWxpZGF0aW9uXCI7XHJcbmltcG9ydCB7IGF1dG9CaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcclxuXHJcbi8vIFByb2plY3QgaW5wdXQgY2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PiB7XHJcbiAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgcGVvcGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKFwicHJvamVjdC1pbnB1dFwiLCBcImFwcFwiLCB0cnVlLCBcInVzZXItaW5wdXRcIik7XHJcblxyXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIiN0aXRsZVwiXHJcbiAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiI2Rlc2NyaXB0aW9uXCJcclxuICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiI3Blb3BsZVwiXHJcbiAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICB9XHJcblxyXG4gIGNvbmZpZ3VyZSgpIHtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuc3VibWl0SGFuZGxlcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJDb250ZW50KCk6IHZvaWQge31cclxuXHJcbiAgcHJpdmF0ZSBnYXRoZXJVc2VySW5wdXQoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdm9pZCB7XHJcbiAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlO1xyXG4gICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcclxuICAgIGNvbnN0IGVudGVyZWRQZW9wbGUgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZTtcclxuXHJcbiAgICBjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBWYWxpZGF0YWJsZSA9IHtcclxuICAgICAgdmFsdWU6IGVudGVyZWRUaXRsZSxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGRlc2NyaXB0aW9uVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICB2YWx1ZTogZW50ZXJlZERlc2NyaXB0aW9uLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgbWluTGVuZ3RoOiA1LFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgIHZhbHVlOiArZW50ZXJlZFBlb3BsZSxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIG1pbjogMSxcclxuICAgICAgbWF4OiA1LFxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgICF2YWxpZGF0ZSh0aXRsZVZhbGlkYXRhYmxlKSB8fFxyXG4gICAgICAhdmFsaWRhdGUoZGVzY3JpcHRpb25WYWxpZGF0YWJsZSkgfHxcclxuICAgICAgIXZhbGlkYXRlKHBlb3BsZVZhbGlkYXRhYmxlKVxyXG4gICAgKSB7XHJcbiAgICAgIGFsZXJ0KFwiSW52YWxpZCBJbnB1dCwgdHJ5IGFnYWluISEhXCIpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gW2VudGVyZWRUaXRsZSwgZW50ZXJlZERlc2NyaXB0aW9uLCArZW50ZXJlZFBlb3BsZV07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNsZWFySW5wdXRzKCkge1xyXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gXCJcIjtcclxuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gXCJcIjtcclxuICB9XHJcblxyXG4gIEBhdXRvQmluZFxyXG4gIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpO1xyXG5cclxuICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpIHtcclxuICAgICAgY29uc3QgW3RpdGxlLCBkZXNjLCBwZW9wbGVdID0gdXNlcklucHV0O1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyhcIkxvZ2dpbmcgdXNlciBpbnB1dFwiLCB0aXRsZSwgZGVzYywgcGVvcGxlKTtcclxuICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QodGl0bGUsIGRlc2MsIHBlb3BsZSk7XHJcbiAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXRcIjtcclxuXHJcbm5ldyBQcm9qZWN0SW5wdXQoKTtcclxubmV3IFByb2plY3RMaXN0KFwiYWN0aXZlXCIpO1xyXG5uZXcgUHJvamVjdExpc3QoXCJmaW5pc2hlZFwiKTtcclxuIl0sIm5hbWVzIjpbIlByb2plY3RTdGF0dXMiLCJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJpZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJQcm9qZWN0U3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lcnMiLCJsaXN0ZW5lckZuIiwidGhpcyIsInB1c2giLCJzdXBlciIsInByb2plY3RzIiwic3RhdGljIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwibmV3UHJvamVjdCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsIkFjdGl2ZSIsInVwZGF0ZUxpc3RlbmVycyIsIm1vdmVQcm9qZWN0IiwicHJvamVjdElkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwcmoiLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwiYXV0b0JpbmQiLCJ0YXJnZXQiLCJtZXRob2ROYW1lIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwiQ29tcG9uZW50IiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhdHRhY2giLCJpbnNlcnRBdEJlZ2lubmluZyIsImluc2VydEFkamFjZW50RWxlbWVudCIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwiY29uZmlndXJlIiwicmVuZGVyQ29udGVudCIsInBlcnNvbnMiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZXZlbnQiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwiY29uc29sZSIsImxvZyIsImFkZEV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwiZHJhZ092ZXJIYW5kbGVyIiwidHlwZXMiLCJwcmV2ZW50RGVmYXVsdCIsImNsYXNzTGlzdCIsImFkZCIsImRyb3BIYW5kbGVyIiwicHJqSWQiLCJnZXREYXRhIiwiRmluaXNoZWQiLCJkcmFnTGVhdmVIYW5kbGVyIiwicmVtb3ZlIiwicmVsZXZhbnRQcm9qZWN0cyIsImZpbHRlciIsInJlbmRlclByb2plY3RzIiwibGlzdElkIiwidG9VcHBlckNhc2UiLCJpbm5lckhUTUwiLCJwcmpJdGVtIiwidmFsaWRhdGUiLCJ2YWxpZGF0ZWJsZUlucHV0IiwiaXNWYWxpZCIsInJlcXVpcmVkIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiUHJvamVjdElucHV0IiwidGl0bGVJbnB1dEVsZW1lbnQiLCJkZXNjcmlwdGlvbklucHV0RWxlbWVudCIsInBlb3BsZUlucHV0RWxlbWVudCIsInN1Ym1pdEhhbmRsZXIiLCJnYXRoZXJVc2VySW5wdXQiLCJlbnRlcmVkVGl0bGUiLCJlbnRlcmVkRGVzY3JpcHRpb24iLCJlbnRlcmVkUGVvcGxlIiwiZGVzY3JpcHRpb25WYWxpZGF0YWJsZSIsInBlb3BsZVZhbGlkYXRhYmxlIiwiYWxlcnQiLCJjbGVhcklucHV0cyIsInVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsImRlc2MiXSwic291cmNlUm9vdCI6IiJ9